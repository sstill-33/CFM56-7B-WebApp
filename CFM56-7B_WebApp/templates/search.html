<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CFM56-7B Maintenance Documentation System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #e8e8e8;
            color: #333;
            font-size: 12px;
            line-height: 1.4;
        }
        
        /* Header Bar - Classic Application Style */
        .header-bar {
            background: linear-gradient(to bottom, #2c3e50 0%, #1a252f 100%);
            color: #fff;
            padding: 8px 15px;
            border-bottom: 2px solid #34495e;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .app-title {
            font-size: 16px;
            font-weight: bold;
            letter-spacing: 0.5px;
        }
        
        .app-subtitle {
            font-size: 11px;
            color: #bdc3c7;
            margin-top: 2px;
        }
        
        /* Main Container */
        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            background: #fff;
            min-height: calc(100vh - 50px);
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        
        /* Toolbar */
        .toolbar {
            background: #ecf0f1;
            border-bottom: 1px solid #bdc3c7;
            padding: 10px 15px;
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .search-group {
            display: flex;
            flex: 1;
            min-width: 300px;
            gap: 5px;
        }
        
        .search-input {
            flex: 1;
            padding: 6px 10px;
            border: 1px solid #95a5a6;
            background: #fff;
            font-size: 12px;
            font-family: 'Courier New', monospace;
        }
        
        .search-input:focus {
            outline: 1px solid #3498db;
            border-color: #3498db;
        }
        
        .search-btn {
            padding: 6px 20px;
            background: #3498db;
            color: white;
            border: 1px solid #2980b9;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
        }
        
        .search-btn:hover {
            background: #2980b9;
        }
        
        .search-btn:active {
            background: #21618c;
        }
        
        /* Category Filter Buttons */
        .category-filters {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
            margin-top: 8px;
        }
        
        .category-btn {
            padding: 4px 12px;
            background: #fff;
            border: 1px solid #bdc3c7;
            cursor: pointer;
            font-size: 11px;
            color: #2c3e50;
            font-weight: 500;
        }
        
        .category-btn:hover {
            background: #ecf0f1;
            border-color: #95a5a6;
        }
        
        .category-btn.active {
            background: #3498db;
            color: white;
            border-color: #2980b9;
        }
        
        /* Stats Panel */
        .stats-panel {
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
            padding: 10px 15px;
            display: flex;
            gap: 20px;
            font-size: 11px;
        }
        
        .stat-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .stat-label {
            color: #6c757d;
        }
        
        .stat-value {
            font-weight: bold;
            color: #2c3e50;
            font-family: 'Courier New', monospace;
        }
        
        /* Results Area */
        .results-area {
            padding: 15px;
        }
        
        .results-header {
            font-size: 11px;
            color: #6c757d;
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 1px solid #dee2e6;
        }
        
        .result-item {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            margin-bottom: 8px;
            padding: 12px;
            transition: all 0.2s;
        }
        
        .result-item:hover {
            background: #e9ecef;
            border-color: #adb5bd;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 8px;
        }
        
        .result-title {
            font-size: 13px;
            font-weight: bold;
            color: #2c3e50;
            text-decoration: none;
            flex: 1;
        }
        
        .result-title:hover {
            color: #3498db;
            text-decoration: underline;
        }
        
        .category-tag {
            display: inline-block;
            padding: 2px 8px;
            background: #3498db;
            color: white;
            font-size: 10px;
            font-weight: bold;
            margin-left: 10px;
            border-radius: 2px;
        }
        
        .result-info {
            font-size: 11px;
            color: #495057;
            margin-bottom: 6px;
        }
        
        .result-part {
            font-family: 'Courier New', monospace;
            color: #e74c3c;
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .result-description {
            color: #6c757d;
            margin-bottom: 8px;
            line-height: 1.5;
        }
        
        .result-details {
            font-size: 10px;
            color: #868e96;
            margin-bottom: 8px;
            padding: 4px 0;
            border-top: 1px dotted #dee2e6;
            padding-top: 6px;
        }
        
        .result-actions {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }
        
        .action-btn {
            padding: 4px 12px;
            font-size: 11px;
            border: 1px solid;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            font-weight: 500;
        }
        
        .action-btn.pdf {
            background: #e74c3c;
            color: white;
            border-color: #c0392b;
        }
        
        .action-btn.pdf:hover {
            background: #c0392b;
        }
        
        .action-btn.image {
            background: #27ae60;
            color: white;
            border-color: #229954;
        }
        
        .action-btn.image:hover {
            background: #229954;
        }
        
        .action-btn.xml {
            background: #95a5a6;
            color: white;
            border-color: #7f8c8d;
        }
        
        .action-btn.xml:hover {
            background: #7f8c8d;
        }
        
        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #6c757d;
        }
        
        .empty-state h3 {
            font-size: 14px;
            color: #495057;
            margin-bottom: 8px;
        }
        
        .empty-state p {
            font-size: 11px;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #6c757d;
            font-size: 12px;
        }
        
        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 12px;
            height: 12px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #95a5a6;
            border-radius: 6px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #7f8c8d;
        }
    </style>
</head>
<body>
    <!-- Header Bar -->
    <div class="header-bar">
        <div class="header-content">
            <div>
                <div class="app-title">CFM56-7B Maintenance Documentation System</div>
                <div class="app-subtitle">Aviation Technical Documentation Search & Access</div>
            </div>
        </div>
    </div>
    
    <!-- Main Container -->
    <div class="main-container">
        <!-- Toolbar -->
        <div class="toolbar">
            <div style="flex: 1; min-width: 100%;">
                <div class="search-group">
                    <input type="text" 
                           id="searchInput" 
                           class="search-input" 
                           placeholder="Enter part number, keyword, or document reference..."
                           onkeyup="handleSearch()"
                           onkeypress="if(event.key==='Enter') performSearch()">
                    <button onclick="performSearch()" class="search-btn">SEARCH</button>
                </div>
                <div class="category-filters">
                    <button class="category-btn active" onclick="filterByCategory('all')">ALL</button>
                    <button class="category-btn" onclick="filterByCategory('EIPC')">EIPC</button>
                    <button class="category-btn" onclick="filterByCategory('ESM')">ESM</button>
                    <button class="category-btn" onclick="filterByCategory('SB')">SB</button>
                    <button class="category-btn" onclick="filterByCategory('CMM')">CMM</button>
                    <button class="category-btn" onclick="filterByCategory('CPM')">CPM</button>
                    <button class="category-btn" onclick="filterByCategory('ITEM')">ITEM</button>
                    <button class="category-btn" onclick="filterByCategory('NDTM')">NDTM</button>
                    <button class="category-btn" onclick="filterByCategory('LLP')">LLP</button>
                    <button class="category-btn" onclick="filterByCategory('SOLUTIONS')">SOLUTIONS</button>
                    <button class="category-btn" onclick="filterByCategory('SPM')">SPM</button>
                    <button class="category-btn" onclick="filterByCategory('TSP')">TSP</button>
                </div>
            </div>
        </div>
        
        <!-- Stats Panel -->
        <div class="stats-panel">
            <div class="stat-item">
                <span class="stat-label">Parts & References:</span>
                <span class="stat-value">{{ database.stats.total_parts }}</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">PDF Documents:</span>
                <span class="stat-value">{{ database.stats.total_documents }}</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Categories:</span>
                <span class="stat-value">{{ database.stats.total_categories }}</span>
            </div>
        </div>
        
        <!-- Results Area -->
        <div class="results-area">
            <div id="searchResults">
                <div class="empty-state">
                    <h3>CFM56-7B Documentation Search</h3>
                    <p>Enter a search term above to find parts, procedures, or references in the maintenance documentation system</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentFilter = 'all';
        
        function handleSearch() {
            const query = document.getElementById('searchInput').value.trim();
            if (query.length >= 2) {
                performSearch();
            } else if (query.length === 0) {
                showEmptyState();
            }
        }
        
        function filterByCategory(category) {
            currentFilter = category;
            
            // Update filter buttons
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Re-run search if there's a query
            const query = document.getElementById('searchInput').value.trim();
            if (query.length >= 2) {
                performSearch();
            }
        }
        
        function performSearch() {
            const query = document.getElementById('searchInput').value.trim();
            if (query.length < 2) {
                showEmptyState();
                return;
            }
            
            // Show loading
            document.getElementById('searchResults').innerHTML = '<div class="loading">Searching documentation...</div>';
            
            // Make API call
            fetch(`/api/search?q=${encodeURIComponent(query)}&category=${currentFilter}`)
                .then(response => response.json())
                .then(data => {
                    displayResults(data.results, query);
                })
                .catch(error => {
                    console.error('Search error:', error);
                    showNoResults();
                });
        }
        
        function displayResults(results, query) {
            const resultsContainer = document.getElementById('searchResults');
            
            if (results.length === 0) {
                showNoResults();
                return;
            }
            
            let html = `<div class="results-header">Found ${results.length} result(s) for "${query}"</div>`;
            
            results.forEach(result => {
                const pdfAction = result.actions.find(a => a.class === 'pdf');
                const titleLink = pdfAction ? pdfAction.url : '#';
                
                html += `
                    <div class="result-item">
                        <div class="result-header">
                            <a href="${titleLink}" class="result-title" target="_blank">
                                ${result.document_title}
                            </a>
                            <span class="category-tag">${result.category}</span>
                        </div>
                        <div class="result-part">Part/Ref: ${result.part_number}</div>
                        <div class="result-description">${result.description}</div>
                        <div class="result-details">${result.details}</div>
                        <div class="result-actions">
                            ${result.actions.map(action => 
                                `<a href="${action.url}" class="action-btn ${action.class || ''}" target="_blank">${action.text}</a>`
                            ).join('')}
                        </div>
                    </div>
                `;
            });
            
            resultsContainer.innerHTML = html;
        }
        
        function showEmptyState() {
            const resultsContainer = document.getElementById('searchResults');
            resultsContainer.innerHTML = `
                <div class="empty-state">
                    <h3>CFM56-7B Documentation Search</h3>
                    <p>Enter a search term above to find parts, procedures, or references in the maintenance documentation system</p>
                </div>
            `;
        }
        
        function showNoResults() {
            const query = document.getElementById('searchInput').value.trim();
            const resultsContainer = document.getElementById('searchResults');
            resultsContainer.innerHTML = `
                <div class="empty-state">
                    <h3>No results found</h3>
                    <p>No matches found for "${query}". Try different keywords or part numbers.</p>
                </div>
            `;
        }
    </script>
</body>
</html>
